{{!< dashboard}}

<style>
  body {
    font-family: 'Poppins', sans-serif;
    background-color: #fff;
    color: #000;
  }

  .container {
    max-width: 600px;
    margin: 0 auto;
    padding: 20px;
  }

  .form-container {
    background-color: #f8f9fa;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }

  .form-label {
    font-weight: 600;
    color: #2E5A92;
    margin-bottom: 8px;
  }

  .form-control {
    border: 2px solid #e9ecef;
    border-radius: 8px;
    padding: 12px;
    font-size: 16px;
    transition: border-color 0.3s ease;
  }

  .form-control:focus {
    border-color: #2E5A92;
    box-shadow: 0 0 0 0.2rem rgba(46, 90, 146, 0.25);
  }

  .btn-primary {
    background-color: #2E5A92;
    border: none;
    padding: 12px 30px;
    border-radius: 8px;
    font-weight: 600;
    transition: background-color 0.3s ease;
  }

  .btn-primary:hover {
    background-color: #1e4a7a;
  }

  .btn-secondary {
    background-color: #6c757d;
    border: none;
    padding: 12px 30px;
    border-radius: 8px;
    font-weight: 600;
    transition: background-color 0.3s ease;
  }

  .btn-secondary:hover {
    background-color: #5a6268;
  }

  .current-file {
    background-color: #e9ecef;
    padding: 10px;
    border-radius: 5px;
    margin-bottom: 15px;
  }

  .current-file a {
    color: #2E5A92;
    text-decoration: none;
  }

  .current-file a:hover {
    text-decoration: underline;
  }

  .info-display {
    background-color: #e9ecef;
    padding: 10px;
    border-radius: 5px;
    margin-bottom: 15px;
    font-weight: 500;
  }
</style>

<div class="container mt-4">
  <div class="form-container">
    <h3 class="mb-4 text-center" style="color: #2E5A92;">Edit Submitted Report</h3>
    
    <form
      action="/admin/submittedReport/update/{{submittedReport.SubmitedReportID}}"
      method="post"
      id="submittedReportForm"
      enctype="multipart/form-data"
      class="needs-validation"
    >
      <div class="mb-3">
        <label class="form-label">Submitted By</label>
        <div class="info-display">
          {{submittedReport.users.Username}}
        </div>
      </div>

      <div class="mb-3">
        <label class="form-label">Report Name</label>
        <div class="info-display">
          {{submittedReport.report.Name}}
        </div>
      </div>

      <div class="mb-3">
        <label for="userID" class="form-label">User ID</label>
        <input 
          type="number" 
          name="UserID" 
          class="form-control" 
          id="userID" 
          value="{{submittedReport.UserID}}"
          required 
        />
        <div class="valid-feedback">Looks good!</div>
      </div>

      <div class="mb-3">
        <label for="reportID" class="form-label">Report ID</label>
        <input 
          type="number" 
          name="ReportID" 
          class="form-control" 
          id="reportID" 
          value="{{submittedReport.ReportID}}"
          required 
        />
        <div class="valid-feedback">Looks good!</div>
      </div>

      {{#if submittedReport.FilePath}}
      <div class="mb-3">
        <label class="form-label">Current File</label>
        <div class="current-file">
          <a href="{{submittedReport.FilePath}}" download id="currentFileName">{{submittedReport.FilePath}}</a>
        </div>
      </div>
      {{/if}}

      <div class="mb-3">
        <label for="submittedReportFile" class="form-label">
          {{#if submittedReport.FilePath}}Replace File (Optional){{else}}Upload File{{/if}}
        </label>
        <input 
          type="file" 
          name="file" 
          class="form-control" 
          id="submittedReportFile"
          {{#unless submittedReport.FilePath}}required{{/unless}}
        />
        <div class="form-text">
          {{#if submittedReport.FilePath}}
            Leave empty to keep the current file
          {{else}}
            Please select a file to upload
          {{/if}}
        </div>
      </div>

      <div class="d-flex gap-2 justify-content-end">
        <a href="/admin/allReports" class="btn btn-secondary">Cancel</a>
        <button class="btn btn-primary" id="updateButton" type="submit">
          Update Submitted Report
        </button>
      </div>
    </form>
  </div>
</div>

<script defer src="/js/admin/editSubmittedReport.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Handle filename display
    const currentFileName = document.getElementById('currentFileName');
    if (currentFileName) {
      const fullPath = currentFileName.textContent;
      const fileName = fullPath.split('\\').pop(); // Get the last part after the last backslash
      currentFileName.textContent = fileName;
    }
  });
</script>
